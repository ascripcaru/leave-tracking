<template bindable="requests,loading">
    <require from="./requests.css"></require>

    <ul if.bind="loading || !requests.length" class="list-group">
        <li class="list-group-item spinner-wrapper">
            <spinner show.bind="loading"></spinner>
            <span show.bind="!loading">You have no requests here!</span>
        </li>
    </ul>

    <ul class="list-group">
        <li repeat.for="request of requests"
            class="list-group-item ${request.status | computeBadge} approval-row">
            <div class="request">
                <div class="name">
                    <strong>${request.userId.fullName}</strong>
                    <div class="created-on">created on ${request.createdAt | dateFormat:'DD/MM/YYYY'}</div>
                </div>
                <div class="period">
                    ${request.workDays | days} : ${request.start | dateFormat}
                    <span show.bind="showExtra(request)">
                    - ${request.end | dateFormat}
                    </span>
                </div>
                <div class="leave-type">
                    <span if.bind="request.comment" class="leave-tooltip">
                        <i class="fa fa-info-circle"></i>&nbsp;
                        <span class="leave-tooltip-text">${request.comment}</span>
                    </span>
                    ${request.leaveType | humanizeLeave}
                </div>
                <div class="buttons" if.bind="request.status === 'pending' && userType !== 'USER'">
                    <button type="button" class="btn btn-default" click.delegate="rejectRequest(request)">
                        <i class="glyphicon glyphicon-remove" style="color: red;"></i>
                    </button>
                    <button type="button" class="btn btn-default" click.delegate="approveRequest(request)">
                        <i class="glyphicon glyphicon-ok" style="color: green;"></i>
                    </button>
                </div>
                <div class="updated-by">
                    <span class="badge badge-pill" if.bind="request.status !== 'pending' && request.lastUpdatedBy">
                        Updated by
                        ${request.lastUpdatedBy.firstName}
                        ${request.lastUpdatedBy.lastName}
                    </span>
                </div>
                <div class="buttons" if.bind="request.status === 'approved' && userType === 'ADMIN'">
                    <a class="btn btn-default"
                       data-analytics-category="approvals"
                       data-analytics-action="edit"
                       href="#/leave-request/${request._id}">Edit</a>
                    <a class="btn btn-default"
                       data-analytics-category="approvals"
                       data-analytics-action="cancel"
                       click.delegate="cancelRequest(request)">Cancel</a>
                </div>
            </div>
        </li>
    </ul>
</template>